<!doctype html>
<html>
<head>

<title>Chess</title>

<link rel="stylesheet" type="text/css" href="static/chessboard.min.css">

<script src="static/jquery.min.js"></script>
<script src="static/chessboard.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <style>
        body{
        background-image:url({{url_for('static',filename='back/background.jpg')}})
        }


    </style>

<h1 style="color: #F4F8FB; margin-left: 30px; margin-top: 5px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; font-size: 90px;">Chess</h1>
</head>
<center>

<body style="background-color: #B1A7FD">
<br>
<br>
<div id="board" style="width: 600px"></div>
<p></p>


<script type="text/javascript">

var board = ChessBoard('board', {
  position: 'start',
  draggable: true,
  onDrop: onDrop
});

var files = {"a": 0, "b": 1, "c": 2, "d": 3, "e": 4, "f": 5, "g": 6, "h": 7};
function get_square(sq) {
  return 8*(parseInt(sq.charAt(1)) - 1) + files[sq.charAt(0)];
}


function onDrop(source, target, piece) {
  if(source == target) return

  var promotion = piece.toLowerCase().charAt(1) == 'p' && parseInt(target.charAt(1)) == 8;

  $.get('/move_coordinates', {'from': get_square(source), 'to': get_square(target), 'promotion': promotion}, function(r) {
    if (r.includes("game over")) {
      document.querySelector('p').innerText = 'game over';
    } else {
      document.querySelector('p').innerText = '';
      board.position(r);
    }
  });
}

function newGame() {
  $.get('/newgame', function(r) {
    document.querySelector('p').innerText = '';
    board.position(r);
  });
}
</script>
<button class = "btn btn-primary btn-block mb-3" style = "background-color: #34364B;
  border: none;
  width: 220px;
  margin-left: 0px;
  margin-top:0px" onclick="newGame()">Reset</button><br/>
</center>

</body>

</html>
